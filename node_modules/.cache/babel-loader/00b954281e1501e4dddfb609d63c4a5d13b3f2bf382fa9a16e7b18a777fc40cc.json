{"ast":null,"code":"var _jsxFileName = \"/Users/abhishekyadav/Desktop/WEBDEV/MERN/the project/FRONTEND/uscripted_records/src/context/PostState.js\",\n  _s = $RefreshSig$();\nimport React, { useState, useEffect } from 'react';\nimport postContext from './postContext';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nexport default function NoteState(props) {\n  _s();\n  const host = \"http://localhost:4000\";\n  const [posts, setPosts] = useState([]);\n  const [hasMore, setHasMore] = useState(true);\n\n  // Function to get posts dynamically based on category engagement\n  const getpost = async (page = 1, reset = false) => {\n    const categoryData = JSON.parse(localStorage.getItem(\"categoryEngagement\")) || {};\n\n    // Sort categories by engagement count\n    const sortedCategories = Object.entries(categoryData).sort(([, a], [, b]) => b - a);\n\n    // Calculate total engagement count\n    const totalEngagement = sortedCategories.reduce((sum, [, count]) => sum + count, 0);\n\n    // Calculate category percentage\n    const categoryDistribution = sortedCategories.map(([category, count]) => ({\n      category,\n      percentage: totalEngagement > 0 ? count / totalEngagement : 1 / sortedCategories.length // Default even distribution if no engagement\n    }));\n\n    // Assign number of posts per category (fetch 10 posts in total)\n    const categoryPostCounts = categoryDistribution.map(({\n      category,\n      percentage\n    }) => ({\n      category,\n      count: Math.round(percentage * 10)\n    }));\n    let allPosts = [];\n    for (const {\n      category,\n      count\n    } of categoryPostCounts) {\n      const response = await fetch(`${host}/posts?page=${page}&limit=${count}&categories=${category}`, {\n        method: \"GET\",\n        headers: {\n          'Content-Type': 'application/json'\n        }\n      });\n      const posts = await response.json();\n      allPosts = [...allPosts, ...posts];\n    }\n\n    // Update state with new posts\n    if (reset) {\n      setPosts(allPosts);\n    } else {\n      setPosts(prevPosts => [...prevPosts, ...allPosts]);\n    }\n    if (allPosts.length < 10) {\n      setHasMore(false); // No more posts to load\n    }\n  };\n\n  // Function to add a post\n  const addpost = async newpost => {\n    const {\n      Title,\n      Subheading,\n      Description,\n      Category\n    } = newpost;\n\n    // API CALL\n    const response = await fetch(`${host}/posts/newpost`, {\n      method: \"POST\",\n      headers: {\n        'Content-Type': 'application/json',\n        'auth-token': localStorage.getItem('token')\n      },\n      body: JSON.stringify({\n        Title,\n        Subheading,\n        Description,\n        Category\n      })\n    });\n    const json = await response.json();\n\n    // Update category engagement count\n    updateCategoryEngagement(Category);\n    getpost(1, true); // Refresh posts after adding\n  };\n\n  // Function to update category engagement when a post is clicked or liked\n  const updateCategoryEngagement = category => {\n    const categoryData = JSON.parse(localStorage.getItem(\"categoryEngagement\")) || {};\n    categoryData[category] = (categoryData[category] || 0) + 1;\n    localStorage.setItem(\"categoryEngagement\", JSON.stringify(categoryData));\n  };\n  return /*#__PURE__*/_jsxDEV(postContext.Provider, {\n    value: {\n      posts,\n      addpost,\n      getpost,\n      hasMore\n    },\n    children: props.children\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 89,\n    columnNumber: 9\n  }, this);\n}\n_s(NoteState, \"oBwjacU+cuIjrFQlKyvBl9ikzfg=\");\n_c = NoteState;\nvar _c;\n$RefreshReg$(_c, \"NoteState\");","map":{"version":3,"names":["React","useState","useEffect","postContext","jsxDEV","_jsxDEV","NoteState","props","_s","host","posts","setPosts","hasMore","setHasMore","getpost","page","reset","categoryData","JSON","parse","localStorage","getItem","sortedCategories","Object","entries","sort","a","b","totalEngagement","reduce","sum","count","categoryDistribution","map","category","percentage","length","categoryPostCounts","Math","round","allPosts","response","fetch","method","headers","json","prevPosts","addpost","newpost","Title","Subheading","Description","Category","body","stringify","updateCategoryEngagement","setItem","Provider","value","children","fileName","_jsxFileName","lineNumber","columnNumber","_c","$RefreshReg$"],"sources":["/Users/abhishekyadav/Desktop/WEBDEV/MERN/the project/FRONTEND/uscripted_records/src/context/PostState.js"],"sourcesContent":["import React, { useState, useEffect } from 'react';\nimport postContext from './postContext';\n\nexport default function NoteState(props) {\n    const host = \"http://localhost:4000\";\n\n    const [posts, setPosts] = useState([]);\n    const [hasMore, setHasMore] = useState(true);\n\n\n    // Function to get posts dynamically based on category engagement\n    const getpost = async (page = 1, reset = false) => {\n        const categoryData = JSON.parse(localStorage.getItem(\"categoryEngagement\")) || {};\n\n        // Sort categories by engagement count\n        const sortedCategories = Object.entries(categoryData).sort(([, a], [, b]) => b - a);\n\n        // Calculate total engagement count\n        const totalEngagement = sortedCategories.reduce((sum, [, count]) => sum + count, 0);\n\n        // Calculate category percentage\n        const categoryDistribution = sortedCategories.map(([category, count]) => ({\n            category,\n            percentage: totalEngagement > 0 ? (count / totalEngagement) : (1 / sortedCategories.length) // Default even distribution if no engagement\n        }));\n\n        // Assign number of posts per category (fetch 10 posts in total)\n        const categoryPostCounts = categoryDistribution.map(({ category, percentage }) => ({\n            category,\n            count: Math.round(percentage * 10)\n        }));\n\n        let allPosts = [];\n\n        for (const { category, count } of categoryPostCounts) {\n            const response = await fetch(`${host}/posts?page=${page}&limit=${count}&categories=${category}`, {\n                method: \"GET\",\n                headers: {\n                    'Content-Type': 'application/json',\n                },\n            });\n\n            const posts = await response.json();\n            allPosts = [...allPosts, ...posts];\n        }\n\n        // Update state with new posts\n        if (reset) {\n            setPosts(allPosts);\n        } else {\n            setPosts(prevPosts => [...prevPosts, ...allPosts]);\n        }\n\n        if (allPosts.length < 10) {\n            setHasMore(false);  // No more posts to load\n        }\n    };\n\n    // Function to add a post\n    const addpost = async (newpost) => {\n        const { Title, Subheading, Description, Category } = newpost;\n\n        // API CALL\n        const response = await fetch(`${host}/posts/newpost`, {\n            method: \"POST\",\n            headers: {\n                'Content-Type': 'application/json',\n                'auth-token': localStorage.getItem('token')\n            },\n            body: JSON.stringify({ Title, Subheading, Description, Category })\n        });\n\n        const json = await response.json();\n\n        // Update category engagement count\n        updateCategoryEngagement(Category);\n\n        getpost(1, true); // Refresh posts after adding\n    };\n\n    // Function to update category engagement when a post is clicked or liked\n    const updateCategoryEngagement = (category) => {\n        const categoryData = JSON.parse(localStorage.getItem(\"categoryEngagement\")) || {};\n        categoryData[category] = (categoryData[category] || 0) + 1;\n        localStorage.setItem(\"categoryEngagement\", JSON.stringify(categoryData));\n    };\n\n    return (\n        <postContext.Provider value={{ posts, addpost, getpost, hasMore }}>\n            {props.children}\n        </postContext.Provider>\n    );\n}\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}